From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Patrick Plenefisch <simonpatp@gmail.com>
Date: Thu, 25 Sep 2014 17:13:37 -0400
Subject: [PATCH 0367/6262] Initial linker script to abstract away the massive
 library list

Change-Id: Iada981fc9d50c640d4c519f5024f48f6b3df7433
---
 .../resources/templates/.cproject             | 20 +++----------------
 ni-libraries/libwpi.so                        |  3 +++
 ni-libraries/libwpi_2015.so                   |  3 +++
 3 files changed, 9 insertions(+), 17 deletions(-)
 create mode 100644 ni-libraries/libwpi.so
 create mode 100644 ni-libraries/libwpi_2015.so

diff --git a/eclipse-plugins/edu.wpi.first.wpilib.plugins.cpp/resources/templates/.cproject b/eclipse-plugins/edu.wpi.first.wpilib.plugins.cpp/resources/templates/.cproject
index 07b1eb4c66489e6a8b3bc6a20fa623c5e53bd7e4..8ad1d444aacd8b68c9b693fda7b1745ceb849136 100644
--- a/eclipse-plugins/edu.wpi.first.wpilib.plugins.cpp/resources/templates/.cproject
+++ b/eclipse-plugins/edu.wpi.first.wpilib.plugins.cpp/resources/templates/.cproject
@@ -30,32 +30,18 @@
 									<listOptionValue builtIn="false" value="&quot;$cpp-location/include&quot;"/>
 								</option>
 								<option id="gnu.cpp.compiler.option.dialect.std.1060340803" name="Language standard" superClass="gnu.cpp.compiler.option.dialect.std" useByScannerDiscovery="true" value="gnu.cpp.compiler.dialect.c++1y" valueType="enumerated"/>
+								<option id="gnu.cpp.compiler.option.other.other.2032328791" name="Other flags" superClass="gnu.cpp.compiler.option.other.other" useByScannerDiscovery="false" value="-c -fmessage-length=0 -pthread -flto" valueType="string"/>
 								<inputType id="cdt.managedbuild.tool.gnu.cpp.compiler.input.1033680971" superClass="cdt.managedbuild.tool.gnu.cpp.compiler.input"/>
 							</tool>
 							<tool id="cdt.managedbuild.tool.gnu.cross.c.linker.362679811" name="Cross GCC Linker" superClass="cdt.managedbuild.tool.gnu.cross.c.linker"/>
 							<tool id="cdt.managedbuild.tool.gnu.cross.cpp.linker.1895838080" name="Cross G++ Linker" superClass="cdt.managedbuild.tool.gnu.cross.cpp.linker">
 								<option id="gnu.cpp.link.option.libs.1363675797" name="Libraries (-l)" superClass="gnu.cpp.link.option.libs" valueType="libs">
-									<listOptionValue builtIn="false" value="WPILibAthena"/>
-									<listOptionValue builtIn="false" value="WPILib"/>
-									<listOptionValue builtIn="false" value="HALAthena"/>
-									<listOptionValue builtIn="false" value="NetworkTables"/>
-									<listOptionValue builtIn="false" value="FRC_NetworkCommunication"/>
-									<listOptionValue builtIn="false" value="i2c"/>
-									<listOptionValue builtIn="false" value="ni_emb"/>
-									<listOptionValue builtIn="false" value="NiFpgaLv"/>
-									<listOptionValue builtIn="false" value="NiFpga"/>
-									<listOptionValue builtIn="false" value="nirio_emb_can"/>
-									<listOptionValue builtIn="false" value="NiRioSrv"/>
-									<listOptionValue builtIn="false" value="ni_rtlog"/>
-									<listOptionValue builtIn="false" value="RoboRIO_FRC_ChipObject"/>
-									<listOptionValue builtIn="false" value="spi"/>
-									<listOptionValue builtIn="false" value="visa"/>
-									<listOptionValue builtIn="false" value="dl"/>
-									<listOptionValue builtIn="false" value="pthread"/>
+									<listOptionValue builtIn="false" value="wpi"/>
 								</option>
 								<option id="gnu.cpp.link.option.paths.1566479969" name="Library search path (-L)" superClass="gnu.cpp.link.option.paths" valueType="libPaths">
 									<listOptionValue builtIn="false" value="&quot;$cpp-location/lib&quot;"/>
 								</option>
+								<option id="gnu.cpp.link.option.flags.19068217" name="Linker flags" superClass="gnu.cpp.link.option.flags" value="-flto" valueType="string"/>
 								<inputType id="cdt.managedbuild.tool.gnu.cpp.linker.input.132949138" superClass="cdt.managedbuild.tool.gnu.cpp.linker.input">
 									<additionalInput kind="additionalinputdependency" paths="$(USER_OBJS)"/>
 									<additionalInput kind="additionalinput" paths="$(LIBS)"/>
diff --git a/ni-libraries/libwpi.so b/ni-libraries/libwpi.so
new file mode 100644
index 0000000000000000000000000000000000000000..429ff806dc0b83aed6553ef00cb13c1ad28a12c7
--- /dev/null
+++ b/ni-libraries/libwpi.so
@@ -0,0 +1,3 @@
+/* GNU ld script */
+OUTPUT_FORMAT(elf32-littlearm)
+INPUT ( -lwpi_2015 )
diff --git a/ni-libraries/libwpi_2015.so b/ni-libraries/libwpi_2015.so
new file mode 100644
index 0000000000000000000000000000000000000000..8920c0e6e5ed01b84973a78e314d0e9d1b53ccbb
--- /dev/null
+++ b/ni-libraries/libwpi_2015.so
@@ -0,0 +1,3 @@
+/* GNU ld script */
+OUTPUT_FORMAT(elf32-littlearm)
+GROUP ( AS_NEEDED ( -lWPILib -lWPILibAthena -lHALAthena -lNetworkTables -lFRC_NetworkCommunication -li2c -lni_emb -lNiFpgaLv -lNiFpga -lnirio_emb_can -lNiRioSrv -lni_rtlog -lRoboRIO_FRC_ChipObject -lspi -lvisa -ldl -lpthread ) )
