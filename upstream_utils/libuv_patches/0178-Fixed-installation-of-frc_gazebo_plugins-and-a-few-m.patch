From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Alex Henning <elcron@gmail.com>
Date: Mon, 21 Jul 2014 11:22:52 -0400
Subject: [PATCH 0178/6262] Fixed installation of frc_gazebo_plugins and a few
 minor fixes.

Change-Id: I1cb30acb69526455469ad890dfee8edd42958a5d
---
 .hgignore                                           | 13 -------------
 simulation/frc_gazebo_plugins/Makefile              |  5 +++++
 simulation/frc_gazebo_plugins/clock/CMakeLists.txt  |  8 ++++----
 .../frc_gazebo_plugins/dc_motor/CMakeLists.txt      |  8 ++++----
 .../frc_gazebo_plugins/encoder/CMakeLists.txt       |  8 ++++----
 .../frc_gazebo_plugins/frc_gazebo_plugins.doxy      |  8 ++++----
 simulation/frc_gazebo_plugins/gyro/CMakeLists.txt   |  8 ++++----
 .../frc_gazebo_plugins/limit_switch/CMakeLists.txt  |  8 ++++----
 simulation/frc_gazebo_plugins/msgs/CMakeLists.txt   |  2 +-
 .../pneumatic_piston/CMakeLists.txt                 |  8 ++++----
 .../pneumatic_piston/src/pneumatic_piston.cpp       |  2 +-
 .../frc_gazebo_plugins/potentiometer/CMakeLists.txt |  8 ++++----
 .../frc_gazebo_plugins/rangefinder/CMakeLists.txt   |  8 ++++----
 13 files changed, 43 insertions(+), 51 deletions(-)
 delete mode 100644 .hgignore

diff --git a/.hgignore b/.hgignore
deleted file mode 100644
index 1ae5e257d1ad981b2933e1b6ce7db98562cce84e..0000000000000000000000000000000000000000
--- a/.hgignore
+++ /dev/null
@@ -1,13 +0,0 @@
-syntax: re
-^\.hgignore$
-.*/target(?:/|$)
-.*/dist(?:/|$)
-eclipse-plugins/.*/bin(?:/|$)
-
-syntax: glob
-wpilibc/build/
-hal/build/
-networktables/cpp/build/
-build/
-networktables/OutlineViewer/nbproject/private
-*~
diff --git a/simulation/frc_gazebo_plugins/Makefile b/simulation/frc_gazebo_plugins/Makefile
index d74071b11264741aac377ec0be6d1d8ef2204a38..cd8fcda2d3681a87e8327c9412f39adca2ce5ed3 100644
--- a/simulation/frc_gazebo_plugins/Makefile
+++ b/simulation/frc_gazebo_plugins/Makefile
@@ -20,6 +20,7 @@ build:
 
 copy-plugins:
 	mkdir -p plugins
+	cp msgs/build/libgz_msgs.so plugins
 	cp dc_motor/build/libgz_dc_motor.so plugins
 	cp pneumatic_piston/build/libgz_pneumatic_piston.so plugins
 	cp potentiometer/build/libgz_potentiometer.so plugins
@@ -41,6 +42,10 @@ clean: clean-docs
 	cd clock && make clean
 	-rm -r plugins
 
+install: all
+	mkdir -p $(DESTDIR)$(plugin.dir)
+	install plugins/* $(DESTDIR)$(plugin.dir)
+
 docs:
 	doxygen frc_gazebo_plugins.doxy
 
diff --git a/simulation/frc_gazebo_plugins/clock/CMakeLists.txt b/simulation/frc_gazebo_plugins/clock/CMakeLists.txt
index 457dfe0b89999d93b167803b5a586fdc911570f2..4872c99eb453ceda97e0d2d5c712b2fed97e4c37 100644
--- a/simulation/frc_gazebo_plugins/clock/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/clock/CMakeLists.txt
@@ -7,11 +7,11 @@ if (PKG_CONFIG_FOUND)
 endif()
 
 find_package(gazebo REQUIRED)
+find_library(GZ_MSGS libgz_msgs.so ../msgs/build)
 
 file(GLOB_RECURSE SRC_FILES src/*.cpp)
-file(GLOB_RECURSE MSG_FILES ../msgs/src/*.cc)
 include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS} ../msgs/src)
-add_library(${PROJECT_NAME} SHARED ${SRC_FILES} ${MSG_FILES})
+add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
-link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build)
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build/)
+target_link_libraries(${PROJECT_NAME} ${GZ_MSGS} ${GAZEBO_LIBRARIES})
diff --git a/simulation/frc_gazebo_plugins/dc_motor/CMakeLists.txt b/simulation/frc_gazebo_plugins/dc_motor/CMakeLists.txt
index 4d7db2047812e3b5d9b5cce26a1a5ae0261a0811..c985f93fcda9d524d6ffd57c876e21a561ce1216 100644
--- a/simulation/frc_gazebo_plugins/dc_motor/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/dc_motor/CMakeLists.txt
@@ -7,11 +7,11 @@ if (PKG_CONFIG_FOUND)
 endif()
 
 find_package(gazebo REQUIRED)
+find_library(GZ_MSGS libgz_msgs.so ../msgs/build)
 
 file(GLOB_RECURSE SRC_FILES src/*.cpp)
-file(GLOB_RECURSE MSG_FILES ../msgs/src/*.cc)
 include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS} ../msgs/src)
-add_library(${PROJECT_NAME} SHARED ${SRC_FILES} ${MSG_FILES})
+add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
-link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build)
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build/)
+target_link_libraries(${PROJECT_NAME} ${GZ_MSGS} ${GAZEBO_LIBRARIES})
diff --git a/simulation/frc_gazebo_plugins/encoder/CMakeLists.txt b/simulation/frc_gazebo_plugins/encoder/CMakeLists.txt
index 270d3a2102b39c50d7095df4a4345f6a0ca28899..707bb7ce98438b323264bd60ff2653ced4c928fb 100644
--- a/simulation/frc_gazebo_plugins/encoder/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/encoder/CMakeLists.txt
@@ -7,11 +7,11 @@ if (PKG_CONFIG_FOUND)
 endif()
 
 find_package(gazebo REQUIRED)
+find_library(GZ_MSGS libgz_msgs.so ../msgs/build)
 
 file(GLOB_RECURSE SRC_FILES src/*.cpp)
-file(GLOB_RECURSE MSG_FILES ../msgs/src/*.cc)
 include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS} ../msgs/src)
-add_library(${PROJECT_NAME} SHARED ${SRC_FILES} ${MSG_FILES})
+add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
-link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build)
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build/)
+target_link_libraries(${PROJECT_NAME} ${GZ_MSGS} ${GAZEBO_LIBRARIES})
diff --git a/simulation/frc_gazebo_plugins/frc_gazebo_plugins.doxy b/simulation/frc_gazebo_plugins/frc_gazebo_plugins.doxy
index eebb3ec6a3f3af82aba4781212463ff55e14f262..b8912497eb931b4592f78ade1b9cdde716472a32 100644
--- a/simulation/frc_gazebo_plugins/frc_gazebo_plugins.doxy
+++ b/simulation/frc_gazebo_plugins/frc_gazebo_plugins.doxy
@@ -144,7 +144,7 @@ FULL_PATH_NAMES        = YES
 # will be relative from the directory where doxygen is started.
 # This tag requires that the tag FULL_PATH_NAMES is set to YES.
 
-STRIP_FROM_PATH        =
+STRIP_FROM_PATH        = 
 
 # The STRIP_FROM_INC_PATH tag can be used to strip a user-defined part of the
 # path mentioned in the documentation of a class, which tells the reader which
@@ -234,7 +234,7 @@ TCL_SUBST              =
 # members will be omitted, etc.
 # The default value is: NO.
 
-OPTIMIZE_OUTPUT_FOR_C  = YES
+OPTIMIZE_OUTPUT_FOR_C  = NO
 
 # Set the OPTIMIZE_OUTPUT_JAVA tag to YES if your project consists of Java or
 # Python sources only. Doxygen will then generate output that is more tailored
@@ -1335,7 +1335,7 @@ ECLIPSE_DOC_ID         = org.doxygen.Project
 # The default value is: NO.
 # This tag requires that the tag GENERATE_HTML is set to YES.
 
-DISABLE_INDEX          = NO
+DISABLE_INDEX          = YES
 
 # The GENERATE_TREEVIEW tag is used to specify whether a tree-like index
 # structure should be generated to display hierarchical information. If the tag
@@ -1352,7 +1352,7 @@ DISABLE_INDEX          = NO
 # The default value is: NO.
 # This tag requires that the tag GENERATE_HTML is set to YES.
 
-GENERATE_TREEVIEW      = NO
+GENERATE_TREEVIEW      = YES
 
 # The ENUM_VALUES_PER_LINE tag can be used to set the number of enum values that
 # doxygen will group on one line in the generated HTML documentation.
diff --git a/simulation/frc_gazebo_plugins/gyro/CMakeLists.txt b/simulation/frc_gazebo_plugins/gyro/CMakeLists.txt
index aca482a89e4329b154d0598efee35ece762ff361..2c3a15e89a0385bd048ee59d720dc4fee6d8bac0 100644
--- a/simulation/frc_gazebo_plugins/gyro/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/gyro/CMakeLists.txt
@@ -7,11 +7,11 @@ if (PKG_CONFIG_FOUND)
 endif()
 
 find_package(gazebo REQUIRED)
+find_library(GZ_MSGS libgz_msgs.so ../msgs/build)
 
 file(GLOB_RECURSE SRC_FILES src/*.cpp)
-file(GLOB_RECURSE MSG_FILES ../msgs/src/*.cc)
 include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS} ../msgs/src)
-add_library(${PROJECT_NAME} SHARED ${SRC_FILES} ${MSG_FILES})
+add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
-link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build)
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build/)
+target_link_libraries(${PROJECT_NAME} ${GZ_MSGS} ${GAZEBO_LIBRARIES})
diff --git a/simulation/frc_gazebo_plugins/limit_switch/CMakeLists.txt b/simulation/frc_gazebo_plugins/limit_switch/CMakeLists.txt
index ecf39aa0c612efbfbd3bfcd15366b7856ab067ec..4935744ee8f710d0a66e54a56fa59ec20db57c0d 100644
--- a/simulation/frc_gazebo_plugins/limit_switch/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/limit_switch/CMakeLists.txt
@@ -7,11 +7,11 @@ if (PKG_CONFIG_FOUND)
 endif()
 
 find_package(gazebo REQUIRED)
+find_library(GZ_MSGS libgz_msgs.so ../msgs/build)
 
 file(GLOB_RECURSE SRC_FILES src/*.cpp)
-file(GLOB_RECURSE MSG_FILES ../msgs/src/*.cc)
 include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS} ../msgs/src)
-add_library(${PROJECT_NAME} SHARED ${SRC_FILES} ${MSG_FILES})
+add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
-link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build)
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build/)
+target_link_libraries(${PROJECT_NAME} ${GZ_MSGS} ${GAZEBO_LIBRARIES})
diff --git a/simulation/frc_gazebo_plugins/msgs/CMakeLists.txt b/simulation/frc_gazebo_plugins/msgs/CMakeLists.txt
index 75926bddf0ef93e3e6977f7ef73654df6443febb..b03c4dca99c1222cc6a5adb9f80703ae9557d1d9 100644
--- a/simulation/frc_gazebo_plugins/msgs/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/msgs/CMakeLists.txt
@@ -13,4 +13,4 @@ include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS})
 add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
 link_directories(${GAZEBO_LIBRARY_DIRS})
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
diff --git a/simulation/frc_gazebo_plugins/pneumatic_piston/CMakeLists.txt b/simulation/frc_gazebo_plugins/pneumatic_piston/CMakeLists.txt
index bee32a9adc876cc9c28f009cbd37186f690e0e15..f4b6206952b7fda41240ab173ef6ba8a9e1e01cc 100644
--- a/simulation/frc_gazebo_plugins/pneumatic_piston/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/pneumatic_piston/CMakeLists.txt
@@ -7,11 +7,11 @@ if (PKG_CONFIG_FOUND)
 endif()
 
 find_package(gazebo REQUIRED)
+find_library(GZ_MSGS libgz_msgs.so ../msgs/build)
 
 file(GLOB_RECURSE SRC_FILES src/*.cpp)
-file(GLOB_RECURSE MSG_FILES ../msgs/src/*.cc)
 include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS} ../msgs/src)
-add_library(${PROJECT_NAME} SHARED ${SRC_FILES} ${MSG_FILES})
+add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
-link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build)
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build/)
+target_link_libraries(${PROJECT_NAME} ${GZ_MSGS} ${GAZEBO_LIBRARIES})
diff --git a/simulation/frc_gazebo_plugins/pneumatic_piston/src/pneumatic_piston.cpp b/simulation/frc_gazebo_plugins/pneumatic_piston/src/pneumatic_piston.cpp
index 682a2e68bd5e3fec4bc98f3ac7f55485b9079779..b865d26901a74b4f3b25041ceaf7d9c103140907 100644
--- a/simulation/frc_gazebo_plugins/pneumatic_piston/src/pneumatic_piston.cpp
+++ b/simulation/frc_gazebo_plugins/pneumatic_piston/src/pneumatic_piston.cpp
@@ -22,7 +22,7 @@ void PneumaticPiston::Load(physics::ModelPtr model, sdf::ElementPtr sdf) {
   }
 
   forward_force = sdf->Get<double>("forward-force");
-  reverse_force = -sdf->Get<double>("reverse-force");
+  reverse_force = sdf->Get<double>("reverse-force");
 
   if (sdf->HasElement("direction") && sdf->Get<std::string>("direction") == "reversed") {
     forward_force = -forward_force;
diff --git a/simulation/frc_gazebo_plugins/potentiometer/CMakeLists.txt b/simulation/frc_gazebo_plugins/potentiometer/CMakeLists.txt
index a3f630a0a46760ee6bea143789c5e95988fae7ba..a62b006275bb55a0c7f9c89292f9b43d8b1d381d 100644
--- a/simulation/frc_gazebo_plugins/potentiometer/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/potentiometer/CMakeLists.txt
@@ -7,11 +7,11 @@ if (PKG_CONFIG_FOUND)
 endif()
 
 find_package(gazebo REQUIRED)
+find_library(GZ_MSGS libgz_msgs.so ../msgs/build)
 
 file(GLOB_RECURSE SRC_FILES src/*.cpp)
-file(GLOB_RECURSE MSG_FILES ../msgs/src/*.cc)
 include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS} ../msgs/src)
-add_library(${PROJECT_NAME} SHARED ${SRC_FILES} ${MSG_FILES})
+add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
-link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build)
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build/)
+target_link_libraries(${PROJECT_NAME} ${GZ_MSGS} ${GAZEBO_LIBRARIES})
diff --git a/simulation/frc_gazebo_plugins/rangefinder/CMakeLists.txt b/simulation/frc_gazebo_plugins/rangefinder/CMakeLists.txt
index 60bcd538730e8dd2e686232546a998aedc7e1936..38b95ad06ecd854ea399f51160e7e1b2ee08f4ec 100644
--- a/simulation/frc_gazebo_plugins/rangefinder/CMakeLists.txt
+++ b/simulation/frc_gazebo_plugins/rangefinder/CMakeLists.txt
@@ -7,11 +7,11 @@ if (PKG_CONFIG_FOUND)
 endif()
 
 find_package(gazebo REQUIRED)
+find_library(GZ_MSGS libgz_msgs.so ../msgs/build)
 
 file(GLOB_RECURSE SRC_FILES src/*.cpp)
-file(GLOB_RECURSE MSG_FILES ../msgs/src/*.cc)
 include_directories(src ${Boost_INCLUDE_DIR} ${GAZEBO_INCLUDE_DIRS} ../msgs/src)
-add_library(${PROJECT_NAME} SHARED ${SRC_FILES} ${MSG_FILES})
+add_library(${PROJECT_NAME} SHARED ${SRC_FILES})
 
-link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build)
-target_link_libraries(${PROJECT_NAME} ${GAZEBO_LIBRARIES})
\ No newline at end of file
+link_directories(${GAZEBO_LIBRARY_DIRS} ../msgs/build/)
+target_link_libraries(${PROJECT_NAME} ${GZ_MSGS} ${GAZEBO_LIBRARIES})
